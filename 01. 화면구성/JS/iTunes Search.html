<!DOCTYPE html>
<html lang="ko">
<body>
  <h2>ğŸµ ìŒì•… ê²€ìƒ‰ (iTunes API)</h2>

  <!-- 1. ê²€ìƒ‰ì–´ ì…ë ¥ì°½ -->
  <input id="search" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥ (ì˜ˆ: BTS)">
  <!-- 2. ê²€ìƒ‰ ë²„íŠ¼ -->
  <button id="btn">ê²€ìƒ‰</button>
  <!-- 3. ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë„£ì„ ul -->
  <ul id="result"></ul>

  <script>
    // ê²€ìƒ‰ì–´ ì…ë ¥ì°½ ìš”ì†Œ
    const search = document.querySelector("#search");
    // ê²€ìƒ‰ ë²„íŠ¼ ìš”ì†Œ
    const search_btn = document.querySelector("#btn");
    // ê²°ê³¼ë¥¼ í‘œì‹œí•  ul ìš”ì†Œ
    const result = document.querySelector("#result");

    // ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì‹¤í–‰í•  í•¨ìˆ˜
    let searchIn = () => {
      // 1) inputì— ì íŒ ê²€ìƒ‰ì–´ë¥¼ ê°€ì ¸ì˜¨ë‹¤ (ë¬¸ìì—´)
      const keyword = search.value.trim();  // ì˜ˆ: "BTS", "ì•„ì´ìœ "

      // ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆìœ¼ë©´ ê·¸ëƒ¥ ì¢…ë£Œ (API ì•ˆ ë¶ˆëŸ¬ê°)
      if (!keyword) {
        console.log("ê²€ìƒ‰ì–´ ì—†ìŒ");
        return;
      }

      // 2) ê²€ìƒ‰ì–´ë¥¼ URLì— ë¼ì›Œ ë„£ê¸° ìœ„í•´ ì¸ì½”ë”©í•œë‹¤
      //    í•œê¸€, ê³µë°± ê°™ì€ ê±¸ URLì—ì„œ ì•ˆì „í•˜ê²Œ ì“°ê²Œ ë°”ê¿”ì¤Œ
      const encoded = encodeURIComponent(keyword);

      // 3) ìµœì¢… ìš”ì²­ ë³´ë‚¼ URLì„ ë§Œë“ ë‹¤
      //    template literal (ë°±í‹± + ${ë³€ìˆ˜}) ì‚¬ìš©
      const searchUrl =
        `https://itunes.apple.com/search?term=${encoded}&entity=song&limit=5`;

      // 4) fetchë¡œ iTunes APIì— ìš”ì²­ ë³´ë‚´ê¸°
      fetch(searchUrl)
        // ì‘ë‹µ(response) ê°ì²´ ë°›ëŠ” then
        .then(response => {
          console.log("response:", response);

          // ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ëŒ€ê°€ ì•„ë‹ˆë©´ (ì„±ê³µì´ ì•„ë‹ˆë©´) ì—ëŸ¬ ë˜ì§€ê¸°
          if (!response.ok) {
            throw new Error("ê²€ìƒ‰ ì‹¤íŒ¨");
          }

          // ì‘ë‹µ ë°”ë””ë¥¼ JSONìœ¼ë¡œ íŒŒì‹± (ì´ê²ƒë„ Promiseë¼ì„œ return)
          return response.json();
        })
        // JSON íŒŒì‹±ì´ ëë‚œ í›„ ì‹¤ì œ ë°ì´í„°(data)ë¥¼ ë°›ëŠ” then
        .then(data => {
          console.log("data:", data);

          // 5) ì´ì „ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì§€ì›Œì¤€ë‹¤ (ìƒˆ ê²€ìƒ‰ ê²°ê³¼ë¡œ ë®ì–´ì“°ê¸° ìœ„í•´)
          result.innerHTML = "";

          // data.resultsê°€ ì—†ê±°ë‚˜, ê¸¸ì´ê°€ 0ì´ë©´ â†’ ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ
          if (!data.results || data.results.length === 0) {
            const li = document.createElement("li");
            li.textContent = "ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ";
            result.appendChild(li);
            return;  // ì—¬ê¸°ì„œ í•¨ìˆ˜ ì¢…ë£Œ
          }

          // 6) ê²°ê³¼ê°€ ìˆì„ ë•Œ: ê° ë…¸ë˜ ì •ë³´ë¥¼ lië¡œ ë§Œë“¤ì–´ì„œ ulì— ì¶”ê°€
          data.results.forEach(item => {
            // item: ê° ë…¸ë˜ ì •ë³´ ê°ì²´ í•˜ë‚˜
            // ì˜ˆ: { artistName: "BTS", trackName: "Dynamite", ... }

            const li = document.createElement("li");

            // "ê°€ìˆ˜ - ë…¸ë˜ì œëª©" í˜•íƒœë¡œ í…ìŠ¤íŠ¸ ë„£ê¸°
            li.textContent = `${item.artistName} - ${item.trackName}`;

            // ë§Œë“  lië¥¼ ul(#result) ì•ˆì— ë¶™ì´ê¸°
            result.appendChild(li);
          });
        })
        // 7) fetch, ì‘ë‹µ ì²˜ë¦¬, JSON íŒŒì‹± ì¤‘ ì—ëŸ¬ê°€ ë‚˜ë©´ ì—¬ê¸°ë¡œ ì˜´
        .catch(error => {
          console.log("fail:", error);
        });
    };

    // 8) ê²€ìƒ‰ ë²„íŠ¼ì´ í´ë¦­ë  ë•Œë§ˆë‹¤ searchIn í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì´ë²¤íŠ¸ ë“±ë¡
    search_btn.addEventListener("click", searchIn);
  </script>
</body>
</html>
